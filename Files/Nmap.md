#Pentest  
# Manual de Nmap

## Introducción
Nmap (Network Mapper) es una herramienta de código abierto para exploración de redes y auditoría de seguridad. Nmap es extremadamente versátil y puede realizar tareas como descubrimiento de hosts, detección de sistemas operativos, escaneo de puertos y ejecución de scripts específicos para la detección de vulnerabilidades.

## Instalación
En sistemas basados en Debian/Ubuntu:

```bash
sudo apt-get install nmap
```

En sistemas basados en Red Hat/CentOS:

```bash
sudo yum install nmap
```

Para macOS:
```bash
brew install nmap
```

## Escaneo Básico

### Escaneo de Puertos
El escaneo básico de puertos se realiza con el siguiente comando:
```bash
nmap <IP-Objetivo>
```

Esto escaneará los 1000 puertos más comunes en el host objetivo.

### Escaneo de Puertos Específicos
Para escanear puertos específicos, puedes utilizar la opción `-p`:
```bash
nmap -p 80,443 <IP-Objetivo>
```

### Escaneo de Todo el Rango de Puertos
Para escanear todos los puertos (1-65535):
```bash
nmap -p- <IP-Objetivo>
```

## Evitar Detección (Evasión)

### Usar Modo Sigiloso (`-sS`)
El modo sigiloso (TCP SYN scan) es uno de los métodos más efectivos para evitar la detección en sistemas IDS/IPS:
```bash
nmap -sS <IP-Objetivo>
```

### Cambiar Velocidad de Escaneo (`-T0` a `-T5`)
Reducir la velocidad del escaneo puede ayudar a evadir la detección. `-T0` es el más sigiloso, pero también el más lento.
```bash
nmap -T0 <IP-Objetivo>
```

### Fragmentar Paquetes (`-f`)
Fragmentar los paquetes puede hacer que sea más difícil para los firewalls detectar el escaneo.
```bash
nmap -f <IP-Objetivo>
```

### Usar Decoys (`-D`)
Para ocultar tu IP real, puedes usar IPs de señuelo (decoys). Esto confunde al sistema de detección haciéndole pensar que el escaneo proviene de múltiples fuentes.
```bash
nmap -D RND:10 <IP-Objetivo>
```
Este comando usará 10 IPs aleatorias como señuelos.

### Usar una Fuente de IP Falsa (`-S`)
Este método requiere que tengas control sobre el rango de IP que usas como fuente:
```bash
nmap -S <IP-Falsa> <IP-Objetivo>
```

## Uso de Scripts Nmap

### Escaneo de Vulnerabilidades en Servicios Conocidos

#### HTTP (Puerto 80/443)
Para escanear vulnerabilidades en un servidor web:
```bash
nmap --script=http-vuln* <IP-Objetivo> -p 80,443
```
Este comando ejecuta scripts de vulnerabilidad relacionados con HTTP.

#### SMB (Puerto 445)
Para escanear vulnerabilidades en el servicio SMB (usualmente Windows):
```bash
nmap --script=smb-vuln* <IP-Objetivo> -p 445
```
Este comando ejecuta scripts para detectar vulnerabilidades SMB conocidas, como EternalBlue.

#### DNS (Puerto 53)
Para detectar problemas comunes en servidores DNS:
```bash
nmap --script=dns* <IP-Objetivo> -p 53
```

#### FTP (Puerto 21)
Para detectar vulnerabilidades en servidores FTP:
```bash
nmap --script=ftp-vuln* <IP-Objetivo> -p 21
```

### Ejecución de Scripts Específicos
Puedes ejecutar scripts específicos desde la línea de comandos. Por ejemplo, para ejecutar un script que verifica la versión de un servidor MySQL:
```bash
nmap --script=mysql-info <IP-Objetivo> -p 3306
```

### Listar Scripts Disponibles
Para listar todos los scripts disponibles en Nmap:
```bash
ls /usr/share/nmap/scripts/
```

### Descargar y Actualizar Scripts
Para mantener tus scripts actualizados:
```bash
nmap --script-updatedb
```

## Escaneo de Detección de Sistema Operativo (`-O`)
Nmap puede intentar detectar el sistema operativo del host objetivo. Esto se realiza con la opción `-O`:
```bash
nmap -O <IP-Objetivo>
```

## Ejemplos de Escaneos Combinados

### Escaneo Sigiloso y Detección de OS
```bash
nmap -sS -O <IP-Objetivo>
```

### Escaneo Completo de Puertos y Ejecución de Scripts
```bash
nmap -p- --script=vuln <IP-Objetivo>
```

### Escaneo Sigiloso con Fragmentación y Señuelos
```bash
nmap -sS -f -D RND:10 <IP-Objetivo>
```

## Conclusión
Nmap es una herramienta poderosa que permite realizar tareas de reconocimiento y auditoría de seguridad. Sin embargo, es crucial usarla de manera ética y legal. El uso indebido de Nmap puede tener consecuencias legales.

---

**Nota**: Asegúrate de tener permiso para escanear cualquier sistema antes de realizar un escaneo. Los escaneos no autorizados pueden ser ilegales y detectados fácilmente por sistemas de seguridad.

Este manual cubre las funciones principales de Nmap, estrategias para evitar la detección, y ejemplos de scripts útiles para servicios comunes. ¿Te gustaría que agregue o ajuste algo más en el manual?